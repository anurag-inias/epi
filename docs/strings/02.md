# Base conversion

## Description

Write a program that performs base conversion from base $b_1$ to base $b_2$. Assume $b_1, b_2 \in [2, 16]$. Use hexadecimal representation for digits in range $10..15$.

## Stub

```kotlin
  fun convertBase(numAsString: String, b1: Int, b2: Int): String {
  // Fill here.
}
```

## Solution

??? "Expand"

    === "Part 1: Parse string to num in base $b_1$"

        We are assuming the number to be non-negative.

        ```kotlin
        // Parses string to number in given base.
        private fun String.toNum(base: Int): Int {
          var num = 0
          for (c in this) {
            num = base * num + c.toValue()
          }
          return num
        }

        // Tackles conversion of digits in range A..F to 10..15.
        private fun Char.toValue() = when(this) {
          in 'A'..'F' -> 10 + (this - 'A')
          else -> this.digitToInt()
        }
        ```

    === "Part 2: Convert num to string in base $b_2$"

        Converting a number to a given base $b$ is same as how we do it for binary:

        > Repeated division by $b$ until we exhaust the number, collecting the remainders in reverse order.
        > Use a `do-while` loop though.

        ```kotlin
        @JvmStatic
        @EpiTest(testDataFile = "convert_base.tsv")
        fun convertBase(numAsString: String, b1: Int, b2: Int): String {
          if (numAsString.isNotEmpty() && numAsString[0] == '-') {
            return "-" + helper(numAsString.substring(1), b1, b2)
          }
          return helper(numAsString, b1, b2)
        }

        // Basically [convertBase] with the assumption that numAsString is non-negative.
        fun helper(numAsString: String, b1: Int, b2: Int): String {
          var n = numAsString.toNum(b1)
          val sb = StringBuilder()
          do { // (1)
            sb.append((n % b2).toDigit())
            n /= b2
          }
          while (n != 0)
          return sb.reversed().toString()
        }

        // Tackles conversion of digits in range 10..15  to A..F.
        private fun Int.toDigit() = when(this) {
          in 10..15 -> 'A' + (this - 10)
          else -> this.digitToChar()
        }
        ```

        1. a `while` loop will simply convert `0` to `""`. So we use a `do-while`.