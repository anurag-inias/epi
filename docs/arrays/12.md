# Sample online data

## Description

There is an ongoing (potentially never ending) stream of integer $s$. Write an algorithm to continuously maintaining a uniform random subset of size $k$.

## Stub

```kotlin
fun onlineRandomSample(stream: MutableIterator<Int>, k: Int): MutableList<Int> {
  // TODO - you fill in here.
}
```

## Solution

??? "Expand"

    [Reservoir Sampling](/algorithms/random/reservoir-sampling)

    ```kotlin
    fun onlineRandomSample(
      stream: MutableIterator<Int>,
      k: Int
    ): MutableList<Int> {
      val list = ArrayList<Int>(k);
      for (i in 1..k) {
        if (stream.hasNext()) list.add(stream.next())
        else return list // stream ended early
      }

      var count = k
      val rand = ThreadLocalRandom.current()
      while (stream.hasNext()) {
        val n = stream.next()
        count++

        val index = rand.nextInt(count)
        if (index < k) {
          list[index] = n
        }
      }

      return list
    }
    ```