# Compute $x ^ y$ without arithmetical operators

## Description

Implement `pow` algorithm without using operator itself.

## Stub

```java
public static int pow(int x, int y) {
  // Fill me.
}
```

## Solution

??? "First approach"

    Repeated subtractions.

??? "Second approach"

    Instead of subtracting `y` over and over again, tru to get more work done in each ioteration. 

    We compute the largest $k$ such that $2^k y \le x$, and if found, subtract $2^k y$ from $x$.


    ```kotlin
    fun divide(x: Int, y: Int): Pair<Int, Int> {
      return when {
        x == 0 -> 0 to 0
        y == 0 -> throw ArithmeticException()
        x > 0 && y > 0 -> divideInternal(x, y)
        x < 0 && y < 0 -> {
          val (q, r) = divideInternal(-x, -y)
          q to -r
        }
        else -> {
          val (q, r) = divideInternal(abs(x), abs(y))
          -q to if (y < 0) r else -r
        }
      }
    }
    
    fun divideInternal(x: Int, y: Int): Pair<Int, Int> {
      var p = 32
      var yp = y shl p
      var a = x
      var quotient = 0

      while (a >= y) { // (1)
        while (yp > a) { // (2) power is too large, dial it down
          p--
          yp = y shl p
        }
        a -= yp // (3)
        quotient += 1 shl p
      }
      return quotient to a
    }
    ```

    1. i.e. $x \ge y$
    2. i.e. $2^p y > x$
    3. i.e. $x = x - 2^p y$

## Unit tests

```kotlin
@Test
fun first() {
  assertThat(divide(4, 2)).isEqualTo(2 to 0)
}

@Test
fun second() {
  assertThat(divide(2, 3)).isEqualTo(0 to 2)
}

@Test
fun third() {
  assertThat(divide(-8, -2)).isEqualTo(4 to 0)
}

@Test
fun fourth() {
  assertThat(divide(-8, -9)).isEqualTo(0 to -8)
}

@Test
fun fifth() {
  assertThat(divide(-8, 2)).isEqualTo(-4 to 0)
  assertThat(divide(8, -2)).isEqualTo(-4 to 0)
}

@Test
fun sixth() {
  assertThat(divide(-8, 12)).isEqualTo(0 to -8)
  assertThat(divide(8, -12)).isEqualTo(0 to 8)
}


@Test
fun random() {
  val rand = ThreadLocalRandom.current()
  for (i in 1..100) {
    val a = rand.nextInt()
    val b = rand.nextInt()
    println("dividing $a by $b, expecting ${a / b}")
    assertThat(divide(a, b)).isEqualTo(a / b to a % b)
  }
}
```
